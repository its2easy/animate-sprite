/*!
 @its2easy/animate-sprite 1.1.1
 https://github.com/its2easy/animate-sprite
         
 Copyright (c) 2020 Dmitry Kovalev,
 Released under the MIT license
*/
function e(e,t={}){if(!(e instanceof HTMLElement||e instanceof Element||e instanceof HTMLDocument))throw new TypeError("Node is required");let r,o,n,s,a,u,c,i,f=function(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var r=Object(e),o=1;o<arguments.length;o++){var n=arguments[o];if(null!=n)for(var s=Object.keys(Object(n)),a=0,u=s.length;a<u;a++){var c=s[a],i=Object.getOwnPropertyDescriptor(n,c);void 0!==i&&i.enumerable&&(r[c]=n[c])}}return r}({width:100,height:100,frames:24,cols:!1,loop:!1,frameTime:!1,duration:!1,fps:24,reverse:!1,autoplay:!1,draggable:!1},t,function(e,t){let r={};return t.forEach(t=>{if(void 0!==e.dataset[t.toLowerCase()]){let o=e.dataset[t.toLowerCase()];"true"===o||""===o?o=!0:"false"===o&&(o=!1),r[t]=o}}),r}(e,["width","height","frames","cols","loop","frameTime","duration","fps","reverse","autoplay","draggable"])),m=1,p=!1,l=!1,h={},d=0,v={};const g=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"];function y(t){e.style.backgroundPosition=function(e){let t,r=0;f.cols?(t=(e-1)%f.cols*s,r=Math.floor((e-1)/f.cols)*a):t=(e-1)*s;return`-${t}px -${r}px`}(t)}function b(t){var r,o;t!==m&&(!function(e){return e<=0||e>f.frames}(t)?(y(t),o=t,(r=m)===f.frames-1&&o===f.frames?e.dispatchEvent(new Event("sprite:last-frame")):2===r&&1===o&&e.dispatchEvent(new Event("sprite:first-frame")),m=t):f.loop?b(Math.abs(Math.abs(t)-f.frames)):(v.stop(),b(t<1?1:f.frames)))}function w(e,t){return void 0===t&&(t=f.reverse),t?m-e:m+e}function E(e,t,r){return e?e*f.frames:t||f.frames/r*1e3}function M(e){const t=(e-o)/r*f.frames;t>=1&&(b(w(Math.floor(t))),o=performance.now()),p&&requestAnimationFrame(M)}function L(){v.stop(),u=f.width/f.height,s=e.offsetWidth,a=s/u,e.style.height=a+"px",n=s/f.frames,c=f.cols?f.cols*s:f.frames*s,i=f.cols?Math.ceil(f.frames/f.cols)*a:a,e.style.backgroundSize=`${c}px ${i}px`,b(1)}function X(t){let r;switch(void 0!==t.touches&&t.touches.length&&(r=t.touches),h.curX=r?r[0].pageX:t.clientX,h.curY=r?r[0].pageY:t.clientY,t.type){case"mousedown":case"touchstart":"touchstart"===t.type&&t.preventDefault(),document.addEventListener("mouseup",X),document.addEventListener("mousemove",X),p=!1,l=!0,e.style.cursor="grabbing",document.body.style.cursor="grabbing",h.prevX=h.curX,h.prevY=h.curY;break;case"mousemove":case"touchmove":"touchmove"===t.type&&t.preventDefault(),l&&function(){const e=function(){let e,t,r,o;e=h.prevX-h.curX,t=h.prevY-h.curY,r=Math.atan2(t,e),o=Math.round(180*r/Math.PI),o<0&&(o=360-Math.abs(o));return o>=0&&o<=60||o<=360&&o>=300?"left":o>=120&&o<=240?"right":o>=241&&o<=299?"bottom":"up"}();h.prevY=h.curY;const t=Math.round(Math.abs(h.curX-h.prevX))+d;if(t<=n)return;if("left"!==e&&"right"!==e)return;h.prevX=h.curX;const r=t/s,o=Math.floor(r*f.frames);d=t-n*o,b(w(o,"left"!==e))}();break;case"mouseup":case"touchend":case"touchcancel":"touchend"!==t.type&&"touchcancel"!==t.type||t.preventDefault(),document.removeEventListener("mouseup",X),document.removeEventListener("mousemove",X),h={},l=!1,e.style.cursor="grab",document.body.style.cursor="default"}}var T;return v.play=function(){if(!p)return p=!0,o=performance.now(),requestAnimationFrame(M),this},v.stop=function(){return p=!1,this},v.toggle=function(){return p?v.stop():v.play(),this},v.next=function(){return v.stop(),b(m+1),this},v.prev=function(){return v.stop(),b(m-1),this},v.reset=function(){return v.stop(),b(1),this},v.setFrame=function(e){return v.stop(),b(e),this},v.setReverse=function(e=!0){return f.reverse=!!e,this},v.getCurrentFrame=()=>m,v.isAnimating=()=>p,v.setOption=function(e,t){return"frameTime"!==e&&"duration"!==e&&"fps"!==e||(f.frameTime=f.duration=f.fps=!1,f[e]=+t,r=E(f.frameTime,f.duration,f.fps),p&&(v.stop(),v.play())),this},v.destroy=function(){var t;!function(e,t,r){r.forEach(r=>{e.removeEventListener(r,t)})}(e,X,g),t=L,window.removeEventListener("resize",t)},r=E(f.frameTime,f.duration,f.fps),o=performance.now(),L(),T=L,window.addEventListener("resize",T),f.autoplay&&v.play(),f.draggable&&(function(e,t,r){r.forEach(r=>{e.addEventListener(r,t)})}(e,X,g),e.style.cursor="grab"),v}export{e as init};
//# sourceMappingURL=animate-sprite.esm.min.js.map
